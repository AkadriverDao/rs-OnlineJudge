<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <title>题目生成器</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body{background:#f8f9fa}
    .card{max-width:800px;margin:40px auto;border-radius:1rem}
    textarea{min-height:120px;font-family:monospace}
  </style>
</head>
<body>
<div class="card shadow">
  <div class="card-header bg-primary text-white"><h4 class="mb-0">新建题目</h4></div>
  <div class="card-body">
    <input   id="id"         class="form-control mb-2" placeholder="题号" required>
    <input   id="title"      class="form-control mb-2" placeholder="标题" required>
    <textarea id="desc"      class="form-control mb-2" placeholder="题目描述"></textarea>

    <label class="form-label fw-bold">模板代码</label>
    <textarea id="cpp"       class="form-control mb-2" placeholder="C++ 模板"></textarea>

    <button id="saveBtn" class="btn btn-success w-100" onclick="saveQuestion()">保存题目</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
async function saveQuestion() {
  const payload = {
    id:        document.getElementById('id').value.trim(),
    title:     document.getElementById('title').value.trim(),
    description: document.getElementById('desc').value.trim(),
    templates: {
      cpp:    document.getElementById('cpp').value.trim() || null,
    }
  };
  if (!payload.id) return Swal.fire({icon:'error', title:'题号不能为空'});
  try {
    const res = await fetch('/save', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(payload)
    });
    const text = await res.text();
    Swal.fire({icon: res.ok ? 'success' : 'error', title: text});
  } catch (e) {
    Swal.fire({icon:'error', title:'网络错误'});
  }
}
</script>
</body>
</html>